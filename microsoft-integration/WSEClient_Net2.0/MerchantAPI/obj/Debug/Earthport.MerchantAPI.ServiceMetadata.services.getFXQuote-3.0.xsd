<?xml version="1.0" encoding="UTF-8"?>
<!--
	Document: getFXQuote-3.0.xsd
	Version:  3.0
	Copyright 2009 Earthport Plc. All rights reserved.
-->
<xsd:schema
	xmlns="http://customer.endpoint.earthport.com/api/merchant/v3/services/getFXQuote"
	targetNamespace="http://customer.endpoint.earthport.com/api/merchant/v3/services/getFXQuote"
	xmlns:epcore="http://customer.endpoint.earthport.com/api/merchant/v2/components/core"
	xmlns:epbb="http://customer.endpoint.earthport.com/api/merchant/v3/components/bankBase"
	xmlns:eppo="http://customer.endpoint.earthport.com/api/merchant/v1/components/payoutBase"
	xmlns:xsd="http://www.w3.org/2001/XMLSchema"
	elementFormDefault="qualified" >

   	<xsd:import namespace="http://customer.endpoint.earthport.com/api/merchant/v3/components/bankBase" 
   		schemaLocation="../components/bankBaseTypes-3.0.xsd" />
    <xsd:import namespace="http://customer.endpoint.earthport.com/api/merchant/v2/components/core" 
    	schemaLocation="../components/coreTypes-2.0.xsd" />
    <xsd:import namespace="http://customer.endpoint.earthport.com/api/merchant/v1/components/payoutBase" 
    	schemaLocation="../components/payoutBaseTypes-1.2.xsd" />

	<xsd:annotation>
		<xsd:documentation>
		
			This service is used to retrieve a cross rate between the required sell currency and buy currency.
			
			The buy currency must always match the currency of the beneficiary's bank account.
			
			The response will provide a UID (unique ID) representing an exchange rate which is honoured for a specified duration. 
			This UID should be presented in "payoutRequest" if required / requested.
			
			The service will return a validation exception if the supplied parameters are incorrect or in any of the two scenarios below:
			a) One of the currencies specified is not enabled for FX in Earthport's system.
			b) The data used on the beneficiary bank record is not sufficient to settle in the buy currency. To avoid this, always use the 
				getBeneficiaryBankAccountRequiredData service and specify the buy currency when registering a new bank account.
			
		</xsd:documentation>
	</xsd:annotation>

	<xsd:element name="getFXQuote" type="GetFXQuoteType">
	</xsd:element>

	<xsd:element name="getFXQuoteResponse"
		type="GetFXQuoteResponseType">
	</xsd:element>

	<xsd:complexType name="GetFXQuoteType">
		<xsd:annotation>
			<xsd:documentation>
			
			The service can be used in two different ways:
			
			a) Only sellAmount and buyCurrency are provided - this is used to secure the amount that will be debited on the user's virtual account.
				Note that the sellAmount element includes both amount and currency.
			
			b) Only buyAmount and sellCurrency are provided - this is used to secure the amount that will be credited on the beneficiary's bank account.
				Note that the buyAmount element includes both amount and currency.
			
			Any other combination of the sellAmount, buyAmount, sellCurrency and buyCurrency elements will result in a validation error.
			
			Input parameters which are required by the "GetFXQuote" service:
			
					The "sellAmount" - Optional - (Please refer to the "MonetaryValueType" element in the coreTypes.xsd file)	
							This represents a monetary value containing a decimal amount value along with a currency code.
							It is the liquidity (actual) amount the merchant is debited in order to buy the Buy Currency.
				
					The "buyCurrency" - Optional - (Please refer to the "CurrencyCodeType" element in the coreTypes.xsd file)
							The currency code of the currency the merchant wishes to buy or convert the sell currency into.
							This must the currency registered for the Beneficiary Bank Account, otherwise the system will return a validation error.
							
					The "buyAmount" - Optional - (Please refer to the "MonetaryValueType" element in the coreTypes.xsd file)
							This represents a monetary value containing a decimal amount value along with a currency code.
							It is the monetary amount the merchant wishes to pay to the beneficiary.
							This must the currency registered for the Beneficiary Bank Account, otherwise the system will return a validation error.
							
					The "sellCurrency" - Optional - (Please refer to the "MonetaryValueType" element in the coreTypes.xsd file)	
							This represents a monetary value containing a decimal amount value along with a currency code.
							For a Payment Request this must be one of the currencies registered for the Payers Bank Account, 
							otherwise the Earthport system will throw a validation error.
											
					"serviceLevel" - Optional - (Please refer to the "ServiceLevelType" element in the payoutTypes.xsd file)
							This determines the level of service with which the payment will be processed, either standard or express. 
							If a serviceLevel is not provided, a default value of "standard" will be applied.
				
					The "usersBankID" - Mandatory - (Please refer to the "UsersBankIDType" element in the baseBankType.xsd file)
							The "users bank ID" contains the "userID" of the merchant and the "benBankID", representing the registered Bank Account
							associated with the User/Merchant/Sub merchant, into which funds may be paid. The Beneficiary Bank account must belong to 
							the user represented by the "userID". If not, the Earthport system will generate a validation error. 
							Both the "userID" and "benBankID" elements are mandatory.
							
			</xsd:documentation>
		</xsd:annotation>

		<xsd:sequence>
			<xsd:element name="sellAmount" type="epcore:MonetaryValueType"
				minOccurs="0" maxOccurs="1">
			</xsd:element>
			
			<xsd:element name="buyCurrency" type="epcore:CurrencyCodeType"
				minOccurs="0" maxOccurs="1">
			</xsd:element>

			<xsd:element name="buyAmount" type="epcore:MonetaryValueType"
				minOccurs="0" maxOccurs="1">
			</xsd:element>
			
			<xsd:element name="sellCurrency" type="epcore:CurrencyCodeType"
				minOccurs="0" maxOccurs="1">
		    </xsd:element>

			<xsd:element name="serviceLevel" type="eppo:ServiceLevelType"
				default="standard" minOccurs="0" maxOccurs="1">
			</xsd:element>

			<xsd:element name="usersBankID" type="epbb:UsersBankIDType"
				minOccurs="1" maxOccurs="1">
			</xsd:element>
		</xsd:sequence>

		<xsd:attribute name="version" type="xsd:decimal" use="required" />

	</xsd:complexType>

	<xsd:complexType name="GetFXQuoteResponseType">
		<xsd:annotation>
			<xsd:documentation>
			
			Parameters which are returned by the "GetFXQuote" service response:
			
				The "fxTicketID" - Mandatory - (Please refer to the "UIDType" element in the coreType.xsd file) 
							This is the unique FX quote reference (UID) within the Earthport System. This represents the FX quote made to the Merchant, 
							and is represented as an FX Ticket ID in the "payoutRequest". "payoutRequests" which include a unique FX quote reference (UID)
							will have this information validated against the Earthport system. This check will include currency, amount and FX quote details
							and will also confirm that the quote is still valid. If any element of this check cannot be confirmed of if the quote has expired,
							a validation error will be generated.	
				
				The "fxDetail" - Mandatory - (Please refer to the "FXDetailType" element in the coreType.xsd file).
							This contains details of the buy amount, sell amount and the FX Rate of the FX Quote / ticket. 
							All three elements of the "fxDetail" are mandatory.
							
			</xsd:documentation>
		</xsd:annotation>
		<xsd:sequence>
			<xsd:element name="fxTicketID" type="epcore:UIDType" minOccurs="1"
				maxOccurs="1">
			</xsd:element>
			<xsd:element name="fxDetail" type="epcore:FXDetailType" minOccurs="1"
				maxOccurs="1">
		</xsd:element>
		</xsd:sequence>
	</xsd:complexType>

</xsd:schema>