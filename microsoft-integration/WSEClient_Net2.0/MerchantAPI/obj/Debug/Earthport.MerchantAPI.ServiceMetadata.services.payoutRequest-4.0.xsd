<?xml version="1.0" encoding="UTF-8"?>
<!--
	Document: payoutRequest-4.0.xsd
	Copyright 2010 Earthport Plc. All rights reserved.
-->
<xsd:schema
	xmlns="http://customer.endpoint.earthport.com/api/merchant/v4/services/payoutRequest"
	targetNamespace="http://customer.endpoint.earthport.com/api/merchant/v4/services/payoutRequest"
	xmlns:epcore="http://customer.endpoint.earthport.com/api/merchant/v2/components/core"
	xmlns:epbb="http://customer.endpoint.earthport.com/api/merchant/v3/components/bankBase"
	xmlns:eppo="http://customer.endpoint.earthport.com/api/merchant/v1/components/payoutBase"
	xmlns:xsd="http://www.w3.org/2001/XMLSchema"
	elementFormDefault="qualified" 
	version="4.0">

   	<xsd:import namespace="http://customer.endpoint.earthport.com/api/merchant/v3/components/bankBase" 
   		schemaLocation="../components/bankBaseTypes-3.0.xsd" />
    <xsd:import namespace="http://customer.endpoint.earthport.com/api/merchant/v2/components/core" 
    	schemaLocation="../components/coreTypes-2.0.xsd" />
    <xsd:import namespace="http://customer.endpoint.earthport.com/api/merchant/v1/components/payoutBase" 
    	schemaLocation="../components/payoutBaseTypes-1.2.xsd" />

	<xsd:annotation>
		<xsd:documentation>
		
				This service is used to request a payout to a given beneficiary bank account. 
			
				This service performs a validation on all the Beneficiary Bank data and both payer and beneficiary identities prior 
				to accepting the payout as the minimum requirements may have changed since the data was originally captured.
							
		</xsd:documentation>
	</xsd:annotation>

	<xsd:element name="payoutRequest" type="PayoutRequestType">
		<xsd:annotation>
			<xsd:documentation>
				Root element for the payoutRequest service request XML.
			</xsd:documentation>
		</xsd:annotation>
	</xsd:element>

	<xsd:element name="payoutRequestResponse"
		type="PayoutRequestResponseType">
		<xsd:annotation>
			<xsd:documentation>
				Root element for the payoutRequest service response XML.
			</xsd:documentation>
		</xsd:annotation>
	</xsd:element>

	<xsd:complexType name="PayoutRequestType">
		<xsd:annotation>
			<xsd:documentation>
			
				
				Input parameters which are required by the "payoutRequest" service:
						
							
					The "usersBankID" - Mandatory - (Please refer to the "UserBankType" element of the bankBaseTypes.xsd file)
							This is the reference to the bank to which the payment should be made and which has previously been registered.
				
					The "merchantTransactionReference" - Mandatory - (Please refer to the "MerchantTransactionRefType" element of the 
							coreTypes.xsd file).
							This is a unique reference provided by the merchant to identify the transaction.
							the system will reject any transactions which contain a merchantTransactionReference that has been previously
							used on another transaction.
							It prevents the same transaction from being processed twice.
				
					The "payoutRequestAmount" - Mandatory - (Please refer to the "MonetaryValueType" element of the coreTypes.xsd file)
							This is the amount that will be debited to the merchant account and may differ from the currency in which 
							the beneficiary account is held.
							This element has two mandatory attributes, "currency" and "amount"	

					The "serviceLevel" - Optional - (Please refer to the "ServiceLevelType" element of the payoutBaseTypes.xsd file)
							This is the service level which the client wishes to be used for the transaction. 
							There are two possible values, "standard" and "express", with "standard" being the default value.
					
					The "beneficiaryStatementNarrative" - Optional - (Please refer to the "GenericDescriptionType" element of the 
							coreTypes.xsd file).
							This is the narrative text which will be displayed on the beneficiary bank account statement, where the 
							transaction type or the banking system is able to support such information. 
							Only one line of additional information is allowed.	
				
					The"fxTicketID" - Optional - (Please refer to the "UIDType" element in the coreTypes.xsd file)	
							This is the FX ticket reference, which is unique to the corresponding FX deal relating to the transaction. 
							This unique reference is returned to the client as a response to the "getFXQuote" service initiated by the client.
							If specified, the Earthport system will honour the rate quoted in the "getFXQuote" request as long as the
							rate has not expired. In the event that the rate has expired, the system will return a validation error.
							
					"The "payerType" - Optional - (Please refer to the "PayerType" element in the version of the payoutBaseTypes.xsd file)
							The payerType element defines the source for the payer identity to be applied on the transaction. The possible values are
							pre-configured for each merchant. When payerType = user, it is required that payerIdentity has been added to
							the user account (VAN). If not, a validation error will be returned.
										
					</xsd:documentation>
				</xsd:annotation>
	
		<xsd:sequence>
				
			<xsd:element name="usersBankID" type="epbb:UsersBankIDType"
				minOccurs="1" maxOccurs="1">
			</xsd:element>

			<xsd:element name="merchantTransactionReference"
				type="epcore:MerchantTransactionRefType" minOccurs="1" maxOccurs="1">
			</xsd:element>

			<xsd:element name="payoutRequestAmount"
				type="epcore:MonetaryValueType" minOccurs="1" maxOccurs="1">
			</xsd:element>

			<xsd:element name="serviceLevel" type="eppo:ServiceLevelType"
				default="standard" minOccurs="0" maxOccurs="1">
			</xsd:element>

			<xsd:element name="beneficiaryStatementNarrative"
				type="epcore:GenericDescriptionType" minOccurs="0" maxOccurs="1">
			</xsd:element>

			<xsd:element name="fxTicketID" type="epcore:UIDType" default="0"
				minOccurs="0" maxOccurs="1">
			</xsd:element>
				
			<xsd:element name="payerType"
				type="eppo:PayerType" minOccurs="0" maxOccurs="1">
			</xsd:element>
			
			<xsd:element name="payoutType"
				type="eppo:PayoutType" minOccurs="0" maxOccurs="1">
				<xsd:annotation>
					<xsd:documentation>
						Reserved for future use
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
			
			<xsd:element name="payoutDetails"
				type="eppo:PayoutDetailsType" minOccurs="0" maxOccurs="unbounded">
				<xsd:annotation>
					<xsd:documentation>
						PayoutDetails are reserved for future use
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
		</xsd:sequence>

		<xsd:attribute name="version" type="xsd:decimal" use="required" />

	</xsd:complexType>

	<xsd:complexType name="PayoutRequestResponseType">
		
	<xsd:annotation>
		<xsd:documentation>
		
			Parameters which are returned by the "payoutRequest" service response:
					
				The "epTransactionID" - Mandatory - (Please refer to the "PaymentIDType" element of the coreTypes.xsd file)	
							This is the newly generated payment ID which,
							through its creation indicates that the payout request was successful.
							
				The	"merchantTransactionReference" (Please refer to the "MerchantTransactionRefType" element of the coreTypes.xsd file).
							This is the transaction reference created by the client which can be used to identify the transaction.
					
				The "feeValue" - Optional - (Please refer to the "MonetaryValueType" element of the coreTypes.xsd file).
							This is the fee that would have been applied during the processing of the "payoutRequest"
							
				The "fxMethodExpected - Optional - (Please refer to the "FXMethodType" element of the payoutBaseTypes.xsd file ).
						This is FX method which is to be used during the processing of the payout request.
						There are three possible options which are available
						i) No FX - where the debit and payment currency are the same
						ii) Forward FX - where the debit and payment currencies are different and the Earthport system is able to convert
						    to the currency of the beneficiary bank account.
						iii) FX on receipt - where Earthport is not able to send the currency of the beneficiary bank account but is able
						     to send the debit currency.  The beneficiaries bank will usually convert the amount into the currency held once
							 the money is received.
												
				The "fxRate" - Conditional - (Please refer to the "FXRateType" element of the coreTypes.xsd file ).
						This is the fx rate that has been applied to the transaction. This element contains the "buyCurrency", "sellCurrency" and the FX rate 
						that has been applied and will only be used when the "fxMethodExpected" is "forward fx".
						When used, all three elements are populated. 
						NOTE The FX rate is limited to a maximum of 6 decimal places
				
				The "correspondentChargesExpected" - Mandatory  
						This is a flag which indicates whether or not the payment might be subject to additional fees in the form of Correspondent Charges".
				
				The "liquidityValue" - Mandatory - (Please refer to the "MonetaryValueType" element of the coreTypes.xsd file).
						The liquidity value (actual amount) debited to fund the payout request. This is equivalent to the payoutInstructionAmount.
						
				The "settlementValue" - Mandatory - (Please refer to the "MonetaryValueType" element of the coreTypes.xsd file).
						The settlement value (actual amount) that will be sent by instruction to the bank through which the payment will be transacted. 
						This value may be subject to charges applied by correspondent banks before being received by the beneficiary bank account. 
						This amount will typically match the currency of the beneficiary bank account, unless this instruction will be settled
						using FX on receipt.
							
				The ""acceptedDate" - (Please refer to the "GenericTimestampType" element of the coreTypes.xsd file).
						Timestamp when the payout instruction was accepted by the system. 
						(This is known as - and is the same as - the debitValueDate in the PayoutTransactionDetailType).
				
				The "expectedSettlementDate - (Please refer to the "GenericDateType" element of the coreTypes.xsd file).
						Indicative date when the payout instruction is expected to be settled to the bank. This is calculated by taking into account 
						such things as acceptedDate, the cut-off time and expected timeframe for the beneficiary to receive the funds.
		
			</xsd:documentation>
		</xsd:annotation>
		
		<xsd:sequence>
			<xsd:element name="epTransactionID" type="epcore:PaymentIDType">
			</xsd:element>
			
			<xsd:element name="merchantTransactionReference"
				type="epcore:MerchantTransactionRefType">
			</xsd:element>

			<xsd:element name="feeValue" type="epcore:MonetaryValueType"
				minOccurs="0" maxOccurs="1">
			</xsd:element>

			<xsd:element name="fxMethodExpected"
				type="eppo:FXMethodType" minOccurs="0" maxOccurs="1">
			</xsd:element>

			<xsd:element name="fxRate" type="epcore:FXRateType"
				minOccurs="0" maxOccurs="1">
			</xsd:element>

			<xsd:element name="correspondentChargesExpected"
				type="xsd:boolean" minOccurs="1" maxOccurs="1">
			</xsd:element>

			<xsd:element name="liquidityValue"
				type="epcore:MonetaryValueType" minOccurs="1" maxOccurs="1">
			</xsd:element>

			<xsd:element name="settlementValue"
				type="epcore:MonetaryValueType" minOccurs="1" maxOccurs="1">
			</xsd:element>
			<xsd:element name="acceptedDate" type="epcore:GenericTimestampType"
				minOccurs="0" maxOccurs="1">
     		</xsd:element>
			<xsd:element name="expectedSettlementDate" type="epcore:GenericDateType" minOccurs="0" maxOccurs="1">
			</xsd:element>
		</xsd:sequence>
	</xsd:complexType>

</xsd:schema>